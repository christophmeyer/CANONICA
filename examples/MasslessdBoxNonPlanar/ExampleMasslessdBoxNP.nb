(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47490,       1333]
NotebookOptionsPosition[     42403,       1244]
NotebookOutlinePosition[     42793,       1260]
CellTagsIndexPosition[     42750,       1257]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Section",
 CellChangeTimes->{{3.6911546832731037`*^9, 
  3.691154685889964*^9}},ExpressionUUID->"36c5f032-7f46-4706-b572-\
bb2753ed55fe"],

Cell[TextData[{
 "The ",
 StyleBox["CANONICA",
  FontSlant->"Italic"],
 " package is loaded with"
}], "Text",
 CellChangeTimes->{{3.69607689945234*^9, 3.6960769596267223`*^9}, {
   3.6960801419254007`*^9, 3.696080164699592*^9}, 3.699002555756713*^9, {
   3.6998606648862867`*^9, 
   3.699860665817398*^9}},ExpressionUUID->"9d313a18-b7bf-449d-9a67-\
f670ef30dd21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<../../src/CANONICA.m\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.691149699778109*^9, 3.691149704040081*^9}, {
   3.6911498683750896`*^9, 3.691149868700045*^9}, {3.6911547154576597`*^9, 
   3.691154716998674*^9}, 3.69328564146728*^9, {3.696076856871777*^9, 
   3.6960768569755087`*^9}, {3.696077506119692*^9, 3.696077506470064*^9}, {
   3.696686011563755*^9, 
   3.6966860166769047`*^9}},ExpressionUUID->"73927ce6-3d66-4431-ac96-\
be5983f5f465"],

Cell[TextData[{
 "The differential equation is loaded from the file ",
 "./MasslessDoubleBoxNPDEQ.m ",
 "and assigned to the symbol ",
 StyleBox["aFull", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.6960769778850393`*^9, 3.696077027368045*^9}, {
   3.696077097086562*^9, 3.696077102039546*^9}, {3.696077911738266*^9, 
   3.6960779134048*^9}, {3.6960801923947983`*^9, 3.696080194836356*^9}, 
   3.69900256006767*^9, {3.699354374136136*^9, 
   3.699354384916224*^9}},ExpressionUUID->"9e1cd939-b4ff-4bd7-aa93-\
ca8be6549ca5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<./MasslessDoubleBoxNPDEQ.m\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.691149728152817*^9, 3.69114973305509*^9}, {
   3.691149870686261*^9, 3.691149871025222*^9}, {3.6911547225339823`*^9, 
   3.691154722759338*^9}, {3.6933055840069427`*^9, 3.693305597511188*^9}, {
   3.6960775131155663`*^9, 3.696077516844385*^9}, 
   3.6960802975068073`*^9},ExpressionUUID->"05f20928-710d-4d1d-8da1-\
7665fdb7367c"],

Cell["\<\
The invariants on which the differential equation depends need to be \
specified in a list.\
\>", "Text",
 CellChangeTimes->{{3.6960771292616873`*^9, 3.6960771586581078`*^9}, 
   3.699002564365408*^9, 
   3.699354393057753*^9},ExpressionUUID->"e27051fc-372f-45a9-a8d1-\
67a334b55c85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"invariants", "=", 
   RowBox[{"{", "x", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691149750694868*^9, 3.6911497615636168`*^9}, {
  3.693305619553362*^9, 
  3.6933056200087633`*^9}},ExpressionUUID->"606b7675-fa7b-4df7-9976-\
b318e97de1a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation of the full topology", "Section",
 CellChangeTimes->{{3.69607787109216*^9, 
  3.696077876718933*^9}},ExpressionUUID->"19f49eb5-b82e-41c1-ad7d-\
465d35b32b9c"],

Cell[TextData[{
 "In order to use the recursion over sectors, the boundaries of the sectors \
need to be specified. This information can be extracted from the differential \
equation with the function ",
 StyleBox["SectorBoundariesFromDE", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.696077882533826*^9, 3.696077886709393*^9}, {
   3.696078823018544*^9, 3.69607885175454*^9}, {3.696078970322093*^9, 
   3.696079050810005*^9}, {3.69727618279529*^9, 3.697276210015724*^9}, 
   3.699002576332745*^9},ExpressionUUID->"23fc9975-8656-4154-8693-\
6d46dd3b435f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sectorBoundaries", "=", 
  RowBox[{"SectorBoundariesFromDE", "[", "aFull", "]"}]}]], "Input",
 CellChangeTimes->{
  3.6911498852001*^9, {3.693305650591298*^9, 3.693305665871797*^9}, {
   3.6960772215083723`*^9, 3.696077229829014*^9}, 3.696077524134892*^9, {
   3.697276184179151*^9, 
   3.697276214059803*^9}},ExpressionUUID->"c0720586-c97f-41c3-9577-\
4e70f098dcb7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "12"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.696077524372157*^9, 3.696077673501416*^9, 
  3.6960790573409767`*^9, 3.6960796367955017`*^9, 3.6960802143098927`*^9, 
  3.696080301219611*^9, 3.696081514023188*^9, 3.6966860205591183`*^9, 
  3.697276220531993*^9},ExpressionUUID->"7abc6c98-0cbf-47ee-bf47-\
cead1e82eb72"]
}, Open  ]],

Cell[TextData[{
 "The computation is performed by calling the function ",
 StyleBox["RecursivelyTransformSectors", "Input"],
 " with the differential equation, the invariants and the sector boundaries. \
Furthermore, in the last argument the sectors are specified at which the \
computation starts and ends. Expect the following calculation to take about 4 \
seconds on a single core machine."
}], "Text",
 CellChangeTimes->{{3.696078206533189*^9, 3.6960782721993437`*^9}, {
   3.696079085615664*^9, 3.696079187426343*^9}, {3.6972761853581*^9, 
   3.697276187635374*^9}, 3.699002584470456*^9, {3.701176596185355*^9, 
   3.7011766012585497`*^9}},ExpressionUUID->"f1e4db97-c138-41e1-b5f5-\
d98947b696f5"],

Cell[BoxData[
 RowBox[{"fullResult", "=", 
  RowBox[{"RecursivelyTransformSectors", "[", 
   RowBox[{"aFull", ",", "invariants", ",", "sectorBoundaries", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "11"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.693305677897814*^9, 3.693305684248274*^9}, {
   3.69607724066322*^9, 3.696077275974866*^9}, {3.6960775479669733`*^9, 
   3.696077557263515*^9}, {3.696077735583702*^9, 3.696077742547769*^9}, {
   3.6960778007112293`*^9, 3.6960778009948387`*^9}, {3.696080306864233*^9, 
   3.696080307062495*^9}, 
   3.6972761893544817`*^9},ExpressionUUID->"76de4988-4dfc-4de3-8bcf-\
248798c583d2"],

Cell["\<\
The first entry of the result is the transformation and the second one is the \
resulting differential equation in canonical form.\
\>", "Text",
 CellChangeTimes->{{3.696077592651229*^9, 3.6960776263550377`*^9}, 
   3.699002598627061*^9},ExpressionUUID->"2a3bd393-69f8-4536-aa61-\
b2d7ddefa415"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trafo", "=", 
  RowBox[{"fullResult", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696077629858149*^9, 
  3.696077633494671*^9}},ExpressionUUID->"ec33a285-9a84-478f-8db0-\
f64c3c59b5b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["eps", "3"], " ", "x"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "eps"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["eps", "3"]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "eps"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["eps", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "eps"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["1", "x"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", 
      RowBox[{"1", "+", "x"}]], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["eps", "2"]}], 
      RowBox[{"1", "-", 
       RowBox[{"5", " ", "eps"}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["eps", "2"]}]}]], ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["eps", 
       RowBox[{"x", "-", 
        RowBox[{"2", " ", "eps", " ", "x"}]}]]}], ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", 
     RowBox[{"-", 
      FractionBox["eps", 
       RowBox[{"x", "-", 
        RowBox[{"2", " ", "eps", " ", "x"}]}]]}], ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", 
     FractionBox["1", 
      SuperscriptBox["x", "2"]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "x"}], ")"}]}], "+", 
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{"12", "+", 
             RowBox[{"14", " ", "x"}], "+", 
             SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x", "+", 
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"5", " ", "x"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", "x"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
        SuperscriptBox["x", "2"]}]]}], ",", 
     FractionBox[
      RowBox[{"6", " ", "eps", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "x"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"4", " ", "eps"}]}], ")"}], " ", "x", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"6", "+", "x"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}]], ",", 
     FractionBox[
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x", "+", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"6", "+", 
            RowBox[{"5", " ", "x"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]], ",", "0", ",", "0", ",", "0", ",", 
     
     FractionBox["2", 
      SuperscriptBox["x", "2"]], ",", 
     FractionBox["1", 
      SuperscriptBox["x", "2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{"6", "+", 
         RowBox[{"11", " ", "x"}], "+", 
         RowBox[{"24", " ", "eps", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "x"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"4", " ", "eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "x"}], ")"}]}], "+", "x"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
     FractionBox[
      RowBox[{"6", "+", 
       RowBox[{"9", " ", "x"}], "+", 
       RowBox[{"12", " ", "eps", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"4", " ", "x"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"12", " ", "eps"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"x", "+", 
          SuperscriptBox["x", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"3", " ", "x"}], "+", 
          RowBox[{"4", " ", "eps", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"4", " ", "x"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"4", " ", "eps", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "x"}], ")"}]}], "+", "x"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]], ",", "0", ",", "0", ",", "0", ",", 
     
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["x", "2"]]}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["x", "2"]]}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6960776342042513`*^9, {3.6960777797750893`*^9, 3.69607780485942*^9}, 
   3.696079640682763*^9, 3.696080314328507*^9, 3.696081530142126*^9, 
   3.696686028818454*^9, 
   3.6972762295342197`*^9},ExpressionUUID->"6ea4c84d-8a70-4c34-be3a-\
e13c5092e55b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aEpsForm", "=", 
  RowBox[{"fullResult", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696077646596168*^9, 3.696077652680368*^9}, {
  3.6960777516170263`*^9, 3.6960777527273617`*^9}, {3.6960778144565496`*^9, 
  3.696077814693012*^9}},ExpressionUUID->"f70b4ad8-39bc-427e-a35c-\
dffdc50bc11a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], "x"]}], ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], "x"]}], ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], "x"], ",", "0", ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", "0", ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", "0", ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "eps"}], "+", 
         RowBox[{"4", " ", "eps", " ", "x"}]}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], "x"]}], ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", 
      RowBox[{"-", 
       FractionBox["eps", 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", "0", ",", "0", ",", "0", ",", 
      "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", "0", ",", "0", ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"eps", "+", 
         RowBox[{"3", " ", "eps", " ", "x"}]}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", "0", ",", "0", ",", "0"}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], "x"]}], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"36", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", "0", ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "0", ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "x"}], ")"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", 
      FractionBox[
       RowBox[{"6", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", 
      FractionBox[
       RowBox[{"6", " ", "eps", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "x"}], ")"}]}], 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]], ",", 
      FractionBox[
       RowBox[{"6", " ", "eps"}], "x"], ",", 
      FractionBox[
       RowBox[{"6", " ", "eps"}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", "0", ",", 
      FractionBox["eps", "x"], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}]}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.696077653488839*^9, 3.696077656947309*^9}, 
   3.696077753200541*^9, {3.696077805609993*^9, 3.6960778150450706`*^9}, 
   3.6960796420990677`*^9, 3.696080316633621*^9, 3.696081531327447*^9, 
   3.6966860314973917`*^9, 
   3.697276231347522*^9},ExpressionUUID->"7cef2545-93fb-48fa-8464-\
1349862b134c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphabet", "=", 
  RowBox[{"ExtractIrreducibles", "[", "aEpsForm", "]"}]}]], "Input",
 CellChangeTimes->{{3.696080696528606*^9, 
  3.696080698414605*^9}},ExpressionUUID->"f56f58f8-9d20-485b-8027-\
cff2b7094a3f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", 
   RowBox[{"1", "+", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6960807450681753`*^9, 3.6960813853535147`*^9, 
  3.696081649524768*^9, 3.696686034749249*^9, 
  3.697276232934132*^9},ExpressionUUID->"bca654eb-bd38-4e86-b4e5-\
8b3bf465ab77"]
}, Open  ]],

Cell[TextData[{
 "The \[Epsilon]-form may be verified with ",
 StyleBox["CheckEpsForm", "Input"],
 ":"
}], "Text",
 CellChangeTimes->{{3.6961387699863234`*^9, 3.696138806817401*^9}, {
  3.699002627141934*^9, 
  3.699002627995737*^9}},ExpressionUUID->"f6b12e8c-b7ca-4b07-8a3b-\
fd0a36f11c08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CheckEpsForm", "[", 
  RowBox[{"aEpsForm", ",", "invariants", ",", "alphabet"}], "]"}]], "Input",
 CellChangeTimes->{{3.6960806709667187`*^9, 
  3.696080702697501*^9}},ExpressionUUID->"494904b1-170e-4a87-b3a1-\
b248ee96596d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.696080713870318*^9, 3.696080747772181*^9, 
  3.696080882384721*^9, 3.696081386576948*^9, 3.696081650304789*^9, 
  3.696686035524786*^9, 
  3.697276234160256*^9},ExpressionUUID->"34db023a-65ff-4177-84cd-\
7ee79e23dd9d"]
}, Open  ]],

Cell[TextData[{
 "The matrix-residues can be computed with ",
 StyleBox["CalculateDlogForm", "Input"]
}], "Text",
 CellChangeTimes->{{3.696081169233951*^9, 3.696081190936694*^9}, {
  3.6960812324031267`*^9, 
  3.6960812343743353`*^9}},ExpressionUUID->"da0e61e1-b55a-49b9-a64e-\
7490a449c51c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dlogForm", "=", 
  RowBox[{"CalculateDlogForm", "[", 
   RowBox[{"aEpsForm", ",", "invariants", ",", "alphabet"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.696080710908349*^9, 3.696080713759551*^9}, {
   3.6960807508212337`*^9, 3.696080761332637*^9}, {3.6960810360438633`*^9, 
   3.6960810444251757`*^9}, 
   3.696081390974917*^9},ExpressionUUID->"4594089a-becb-471c-a163-\
1e923b9a9f9c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"2", " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", "0", ",",
        "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{"2", " ", "eps"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "eps"}], ",", "0", ",", 
       RowBox[{"2", " ", "eps"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "eps"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", 
       RowBox[{"-", "eps"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"12", " ", "eps"}], ",", 
       RowBox[{"6", " ", "eps"}], ",", 
       RowBox[{"6", " ", "eps"}], ",", "0", ",", "eps", ",", "0"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"2", " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", "0", ",",
        "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"2", " ", "eps"}], ",", "eps", ",", "0", ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"2", " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "36"}], " ", "eps"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "12"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", 
       RowBox[{"2", " ", "eps"}], ",", "eps", ",", 
       RowBox[{"2", " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "12"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "12"}], " ", "eps"}], ",", 
       RowBox[{"6", " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "12"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "12"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "6"}], " ", "eps"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "6"}], " ", "eps"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}]}], "}"}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.696081391361837*^9, 3.696081651355967*^9, 
  3.696686036384884*^9, 
  3.697276235779236*^9},ExpressionUUID->"1fc42d2c-2b77-4f2a-be31-\
50edc25ef4e2"]
}, Open  ]],

Cell["which are readily cross-checked:", "Text",
 CellChangeTimes->{{3.69608119644376*^9, 
  3.6960812121758423`*^9}},ExpressionUUID->"df6c7cca-7d56-4878-82ab-\
a12c517089cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dlogForm", "[", 
       RowBox[{"[", "nLetter", "]"}], "]"}], "*", 
      RowBox[{"Log", "[", 
       RowBox[{"alphabet", "[", 
        RowBox[{"[", "nLetter", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"nLetter", ",", "1", ",", 
       RowBox[{"Length", "@", "alphabet"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6993584183108883`*^9, 
  3.699358466301895*^9}},ExpressionUUID->"c624d77a-8a98-4cf3-b1b5-\
51d2fe0241b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"A", ",", "x"}], "]"}], "-", 
     RowBox[{"aEpsForm", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6993575816310987`*^9, 3.699357583903214*^9}, 
   3.6993576300446463`*^9, 
   3.699358372287375*^9},ExpressionUUID->"0ff96bd5-c202-458d-b5d6-\
fb9f4007546c"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.699357584300901*^9, 3.699357593987167*^9}, 
   3.699357633366939*^9, 3.6993583727397738`*^9, {3.699358455636476*^9, 
   3.699358469100733*^9}, 
   3.699358511146679*^9},ExpressionUUID->"4fd12f87-6ef2-4806-9b0a-\
02375489b4da"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation of diagonal blocks", "Section",
 CellChangeTimes->{{3.6911545603380613`*^9, 3.691154563124282*^9}, {
   3.696077937466094*^9, 3.6960779420853024`*^9}, 
   3.69607982324893*^9},ExpressionUUID->"883ee0a3-50ec-437c-838b-\
6f45dd4a4be1"],

Cell[TextData[{
 "The function ",
 StyleBox["ExtractDiagonalBlock", "Input"],
 " extracts the diagonal block that is specified by its boundaries."
}], "Text",
 CellChangeTimes->{{3.696079663173656*^9, 
  3.696079732078588*^9}},ExpressionUUID->"87306621-a226-4640-8d6b-\
c95e231ab922"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nDiagonalBlock", "=", "11"}], ";"}]], "Input",
 CellChangeTimes->{{3.6911546349111032`*^9, 3.691154647635448*^9}, {
   3.693289765579372*^9, 3.6932897657037697`*^9}, {3.693289798121139*^9, 
   3.693289861943006*^9}, 3.69607795893613*^9, {3.696080322318939*^9, 
   3.6960803224691353`*^9}},ExpressionUUID->"9d38dafb-0aad-4635-ad44-\
a28726edcf66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{"ExtractDiagonalBlock", "[", 
   RowBox[{"aFull", ",", 
    RowBox[{"sectorBoundaries", "[", 
     RowBox[{"[", "nDiagonalBlock", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691154579796332*^9, 3.6911545979613047`*^9}, 
   3.6911546503012857`*^9, {3.696077955304044*^9, 3.696077956360448*^9}, 
   3.6972761966592283`*^9},ExpressionUUID->"d9abd1f3-f6bf-471b-a045-\
eedba599d77c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", "+", 
         RowBox[{"4", " ", "eps"}], "+", 
         RowBox[{"2", " ", "x"}], "+", 
         RowBox[{"3", " ", "eps", " ", "x"}]}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], "x"]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"4", " ", "eps"}]}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "eps"}], "-", 
        RowBox[{"2", " ", "x"}]}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]]}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.691154598736055*^9, 3.6911546512233667`*^9, 3.691154730944628*^9, 
   3.691158548040571*^9, 3.691227949551581*^9, 3.69122980224294*^9, {
   3.693285667966941*^9, 3.6932856693344584`*^9}, 3.693289769279834*^9, {
   3.693289801342169*^9, 3.693289813436645*^9}, {3.693289843491727*^9, 
   3.693289862754446*^9}, 3.6960779617006207`*^9, 3.69607973562117*^9, 
   3.6960803234069777`*^9, 3.696686039304775*^9, 
   3.697276239131055*^9},ExpressionUUID->"220ae509-9393-4977-bbab-\
b3b3add517b1"]
}, Open  ]],

Cell[TextData[{
 "The transformation to a canonical basis is computed with ",
 StyleBox["TransformDiagonalBlock", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.696079852339901*^9, 3.696079862954475*^9}, {
   3.696080072620203*^9, 3.696080106458168*^9}, 
   3.699002647890517*^9},ExpressionUUID->"3aceb918-3cf4-4b63-9c2d-\
3c2bc81319e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"blockResult", "=", 
  RowBox[{"TransformDiagonalBlock", "[", 
   RowBox[{"a", ",", "invariants"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.69115460201665*^9, 3.691154610033132*^9}, {
   3.693289710786767*^9, 3.69328973620191*^9}, 3.696077970055726*^9, {
   3.696078014847673*^9, 
   3.696078017564032*^9}},ExpressionUUID->"f6de5dd8-f99c-4123-bd3e-\
0f1583c5bf07"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Generating equations at order eps^0.\"\>"], "Print",
 CellChangeTimes->{{3.693289848251402*^9, 3.693289864888879*^9}, {
   3.69607797096386*^9, 3.696077978999517*^9}, 3.696078018452332*^9, 
   3.696080122819881*^9, 3.6960803250890217`*^9, 3.6966860406066637`*^9, 
   3.697276240810383*^9},ExpressionUUID->"c3d2a01c-c682-4578-a5a1-\
c72584878950"],

Cell[BoxData["\<\"Solving equations at order eps^0.\"\>"], "Print",
 CellChangeTimes->{{3.693289848251402*^9, 3.693289864888879*^9}, {
   3.69607797096386*^9, 3.696077978999517*^9}, 3.696078018452332*^9, 
   3.696080122819881*^9, 3.6960803250890217`*^9, 3.6966860406066637`*^9, 
   3.6972762408381433`*^9},ExpressionUUID->"c233a476-de4b-4ca3-b530-\
a8d3fea0dfc7"],

Cell[BoxData["\<\"Checking whether series terminates.\"\>"], "Print",
 CellChangeTimes->{{3.693289848251402*^9, 3.693289864888879*^9}, {
   3.69607797096386*^9, 3.696077978999517*^9}, 3.696078018452332*^9, 
   3.696080122819881*^9, 3.6960803250890217`*^9, 3.6966860406066637`*^9, 
   3.697276240870123*^9},ExpressionUUID->"27eedd0c-9316-4c66-9777-\
e8560d19feb8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["x", "2"]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         SuperscriptBox["x", "2"]]}], ",", 
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"x", "+", 
          SuperscriptBox["x", "2"]}]]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "x"}], ")"}]}], 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
        FractionBox[
         RowBox[{"2", " ", "eps"}], 
         RowBox[{"1", "+", "x"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["eps", "x"], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", "eps"}], 
          RowBox[{"1", "+", "x"}]]}]}], "}"}]}], "}"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6911546277571697`*^9, 3.691154771959179*^9, 3.6911585883384132`*^9, 
   3.691227993240039*^9, 3.6912298480786324`*^9, 3.693285714192841*^9, 
   3.693289731257333*^9, {3.69328976254885*^9, 3.693289867376404*^9}, {
   3.6960779710194407`*^9, 3.696077979052759*^9}, 3.696078018545086*^9, 
   3.69608012290068*^9, 3.6960803251775703`*^9, 3.69668604069383*^9, 
   3.697276240960617*^9},ExpressionUUID->"4bec78e3-4174-42c7-8524-\
34d8d314af22"]
}, Open  ]],

Cell["\<\
Again, the first entry is the transformation and the second one is the \
resulting differential equation in canonical form.\
\>", "Text",
 CellChangeTimes->{{3.696077988824342*^9, 
  3.696078044081538*^9}},ExpressionUUID->"7dfb330f-8257-4037-896e-\
dc19a82e1a88"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trafoBlock", "=", 
  RowBox[{"blockResult", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696078057978483*^9, 
  3.69607806614333*^9}},ExpressionUUID->"89be204d-cefe-4047-a476-\
da389ea0b9ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["x", "2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["x", "2"]]}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.696078058550915*^9, 3.696078066958527*^9}, 
   3.696080124082541*^9, 3.696080326882482*^9, 3.696686042142179*^9, 
   3.697276242040699*^9},ExpressionUUID->"a46c96ad-f3a2-44a2-b870-\
1f74ee0993c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aBlockEpsForm", "=", 
  RowBox[{"blockResult", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696078061976901*^9, 
  3.696078074077878*^9}},ExpressionUUID->"cc944313-ded2-4aae-89c0-\
4f90d18dbb4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "x"}], ")"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["eps", "x"], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}]}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6960780749046087`*^9, 3.696080124966794*^9, 
  3.696080328012477*^9, 3.696686043152258*^9, 
  3.697276242737894*^9},ExpressionUUID->"205d80fe-20c2-402c-9a04-\
8c1d32082ba5"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{933, 771},
WindowMargins->{{7.5, Automatic}, {0, Automatic}},
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"901037da-de34-40c2-aeae-67b2777eee54"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 68, "Section",ExpressionUUID->"36c5f032-7f46-4706-b572-bb2753ed55fe"],
Cell[744, 27, 363, 10, 35, "Text",ExpressionUUID->"9d313a18-b7bf-449d-9a67-f670ef30dd21"],
Cell[1110, 39, 503, 9, 29, "Input",ExpressionUUID->"73927ce6-3d66-4431-ac96-be5983f5f465"],
Cell[1616, 50, 526, 12, 35, "Text",ExpressionUUID->"9e1cd939-b4ff-4bd7-aa93-ca8be6549ca5"],
Cell[2145, 64, 462, 9, 29, "Input",ExpressionUUID->"05f20928-710d-4d1d-8da1-7665fdb7367c"],
Cell[2610, 75, 294, 7, 35, "Text",ExpressionUUID->"e27051fc-372f-45a9-a8d1-67a334b55c85"],
Cell[2907, 84, 279, 7, 29, "Input",ExpressionUUID->"606b7675-fa7b-4df7-9976-b318e97de1a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3223, 96, 179, 3, 68, "Section",ExpressionUUID->"19f49eb5-b82e-41c1-ad7d-465d35b32b9c"],
Cell[3405, 101, 559, 11, 58, "Text",ExpressionUUID->"23fc9975-8656-4154-8693-6d46dd3b435f"],
Cell[CellGroupData[{
Cell[3989, 116, 391, 8, 29, "Input",ExpressionUUID->"c0720586-c97f-41c3-9577-4e70f098dcb7"],
Cell[4383, 126, 998, 29, 33, "Output",ExpressionUUID->"7abc6c98-0cbf-47ee-bf47-cead1e82eb72"]
}, Open  ]],
Cell[5396, 158, 702, 12, 81, "Text",ExpressionUUID->"f1e4db97-c138-41e1-b5f5-d98947b696f5"],
Cell[6101, 172, 638, 12, 29, "Input",ExpressionUUID->"76de4988-4dfc-4de3-8bcf-248798c583d2"],
Cell[6742, 186, 305, 6, 35, "Text",ExpressionUUID->"2a3bd393-69f8-4536-aa61-b2d7ddefa415"],
Cell[CellGroupData[{
Cell[7072, 196, 240, 6, 29, "Input",ExpressionUUID->"ec33a285-9a84-478f-8db0-f64c3c59b5b8"],
Cell[7315, 204, 9892, 303, 515, "Output",ExpressionUUID->"6ea4c84d-8a70-4c34-be3a-e13c5092e55b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17244, 512, 344, 7, 32, "Input",ExpressionUUID->"f70b4ad8-39bc-427e-a35c-dffdc50bc11a"],
Cell[17591, 521, 6112, 180, 372, "Output",ExpressionUUID->"7cef2545-93fb-48fa-8464-1349862b134c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23740, 706, 235, 5, 32, "Input",ExpressionUUID->"f56f58f8-9d20-485b-8027-cff2b7094a3f"],
Cell[23978, 713, 294, 7, 32, "Output",ExpressionUUID->"bca654eb-bd38-4e86-b4e5-8b3bf465ab77"]
}, Open  ]],
Cell[24287, 723, 291, 8, 33, "Text",ExpressionUUID->"f6b12e8c-b7ca-4b07-8a3b-fd0a36f11c08"],
Cell[CellGroupData[{
Cell[24603, 735, 249, 5, 32, "Input",ExpressionUUID->"494904b1-170e-4a87-b3a1-b248ee96596d"],
Cell[24855, 742, 271, 5, 32, "Output",ExpressionUUID->"34db023a-65ff-4177-84cd-7ee79e23dd9d"]
}, Open  ]],
Cell[25141, 750, 292, 7, 33, "Text",ExpressionUUID->"da0e61e1-b55a-49b9-a64e-7490a449c51c"],
Cell[CellGroupData[{
Cell[25458, 761, 414, 9, 32, "Input",ExpressionUUID->"4594089a-becb-471c-a163-1e923b9a9f9c"],
Cell[25875, 772, 6305, 159, 319, "Output",ExpressionUUID->"1fc42d2c-2b77-4f2a-be31-50edc25ef4e2"]
}, Open  ]],
Cell[32195, 934, 175, 3, 33, "Text",ExpressionUUID->"df6c7cca-7d56-4878-82ab-a12c517089cc"],
Cell[32373, 939, 571, 17, 32, "Input",ExpressionUUID->"c624d77a-8a98-4cf3-b1b5-51d2fe0241b8"],
Cell[CellGroupData[{
Cell[32969, 960, 445, 12, 32, "Input",ExpressionUUID->"0ff96bd5-c202-458d-b5d6-fb9f4007546c"],
Cell[33417, 974, 299, 6, 32, "Output",ExpressionUUID->"4fd12f87-6ef2-4806-9b0a-02375489b4da"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33765, 986, 254, 4, 65, "Section",ExpressionUUID->"883ee0a3-50ec-437c-838b-6f45dd4a4be1"],
Cell[34022, 992, 284, 7, 33, "Text",ExpressionUUID->"87306621-a226-4640-8d6b-c95e231ab922"],
Cell[34309, 1001, 381, 7, 32, "Input",ExpressionUUID->"9d38dafb-0aad-4635-ad44-a28726edcf66"],
Cell[CellGroupData[{
Cell[34715, 1012, 435, 9, 32, "Input",ExpressionUUID->"d9abd1f3-f6bf-471b-a045-eedba599d77c"],
Cell[35153, 1023, 1398, 39, 51, "Output",ExpressionUUID->"220ae509-9393-4977-bbab-b3b3add517b1"]
}, Open  ]],
Cell[36566, 1065, 339, 8, 33, "Text",ExpressionUUID->"3aceb918-3cf4-4b63-9c2d-3c2bc81319e5"],
Cell[CellGroupData[{
Cell[36930, 1077, 388, 8, 32, "Input",ExpressionUUID->"f6de5dd8-f99c-4123-bd3e-0f1583c5bf07"],
Cell[CellGroupData[{
Cell[37343, 1089, 364, 5, 23, "Print",ExpressionUUID->"c3d2a01c-c682-4578-a5a1-c72584878950"],
Cell[37710, 1096, 363, 5, 23, "Print",ExpressionUUID->"c233a476-de4b-4ca3-b530-a8d3fea0dfc7"],
Cell[38076, 1103, 363, 5, 23, "Print",ExpressionUUID->"27eedd0c-9316-4c66-9777-e8560d19feb8"]
}, Open  ]],
Cell[38454, 1111, 1608, 49, 52, "Output",ExpressionUUID->"4bec78e3-4174-42c7-8524-34d8d314af22"]
}, Open  ]],
Cell[40077, 1163, 273, 6, 33, "Text",ExpressionUUID->"7dfb330f-8257-4037-896e-dc19a82e1a88"],
Cell[CellGroupData[{
Cell[40375, 1173, 245, 6, 32, "Input",ExpressionUUID->"89be204d-cefe-4047-a476-da389ea0b9ce"],
Cell[40623, 1181, 621, 19, 51, "Output",ExpressionUUID->"a46c96ad-f3a2-44a2-b870-1f74ee0993c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41281, 1205, 249, 6, 32, "Input",ExpressionUUID->"cc944313-ded2-4aae-89c0-4f90d18dbb4a"],
Cell[41533, 1213, 842, 27, 52, "Output",ExpressionUUID->"205d80fe-20c2-402c-9a04-8c1d32082ba5"]
}, Open  ]]
}, Open  ]]
}
]
*)

