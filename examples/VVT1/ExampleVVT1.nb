(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49589,       1428]
NotebookOptionsPosition[     44618,       1345]
NotebookOutlinePosition[     45008,       1361]
CellTagsIndexPosition[     44965,       1358]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Section",
 CellChangeTimes->{{3.6911546832731037`*^9, 
  3.691154685889964*^9}},ExpressionUUID->"1d25afd7-87e3-43c7-b503-\
e4c9ccd08f50"],

Cell[TextData[{
 "The ",
 StyleBox["CANONICA",
  FontSlant->"Italic"],
 " package is loaded with"
}], "Text",
 CellChangeTimes->{{3.69607689945234*^9, 3.6960769596267223`*^9}, {
   3.6960801419254007`*^9, 3.696080164699592*^9}, 3.699003532420322*^9, {
   3.699860575875359*^9, 
   3.69986057603094*^9}},ExpressionUUID->"3ba1f511-81e0-41a8-8389-\
b526c059a9fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<../../src/CANONICA.m\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.691149699778109*^9, 3.691149704040081*^9}, {
   3.6911498683750896`*^9, 3.691149868700045*^9}, {3.6911547154576597`*^9, 
   3.691154716998674*^9}, 3.69328564146728*^9, {3.696076856871777*^9, 
   3.6960768569755087`*^9}, {3.696077506119692*^9, 3.696077506470064*^9}, {
   3.696687078704637*^9, 
   3.696687082355509*^9}},ExpressionUUID->"c9aa1880-e75e-4cc2-8843-\
e48a699b6fb1"],

Cell[TextData[{
 "The differential equation is loaded from the file ",
 "./VVT1DEQ.m ",
 "and assigned to the symbol ",
 StyleBox["aFull", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.6960769778850393`*^9, 3.696077027368045*^9}, {
   3.696077097086562*^9, 3.696077102039546*^9}, {3.696077911738266*^9, 
   3.6960779134048*^9}, {3.6960801923947983`*^9, 3.696080194836356*^9}, 
   3.696139221788289*^9, 3.6990035393305283`*^9, {3.6993554795433693`*^9, 
   3.699355503958391*^9}},ExpressionUUID->"39db69e6-d780-43ab-b4ae-\
b87bade43406"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<./VVT1DEQ.m\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.691149728152817*^9, 3.69114973305509*^9}, {
   3.691149870686261*^9, 3.691149871025222*^9}, {3.6911547225339823`*^9, 
   3.691154722759338*^9}, {3.6933055840069427`*^9, 3.693305597511188*^9}, {
   3.6960775131155663`*^9, 3.696077516844385*^9}, {3.696139155146008*^9, 
   3.696139160468437*^9}, 
   3.697277079505919*^9},ExpressionUUID->"dfb154a4-6f67-46a1-810a-\
20bb4996167e"],

Cell["\<\
The invariants on which the differential equation depends need to be \
specified in a list.\
\>", "Text",
 CellChangeTimes->{{3.6960771292616873`*^9, 3.6960771586581078`*^9}, 
   3.699003547486801*^9, 
   3.699355195051072*^9},ExpressionUUID->"40744f23-c3bb-4820-86b3-\
f144210b557e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"invariants", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691149750694868*^9, 3.6911497615636168`*^9}, {
  3.693305619553362*^9, 3.6933056200087633`*^9}, {3.696139208496766*^9, 
  3.69613920915597*^9}},ExpressionUUID->"f418ade7-456a-4f10-95ce-\
cb52892d4355"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation of the full topology", "Section",
 CellChangeTimes->{{3.69607787109216*^9, 
  3.696077876718933*^9}},ExpressionUUID->"3bb2b905-6a14-463d-9c3f-\
3ef95b1cccce"],

Cell[TextData[{
 "In order to use the recursion over sectors, the boundaries of the sectors \
need to be specified. This information can be extracted from the differential \
equation with the function ",
 StyleBox["SectorBoundariesFromDE", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.696077882533826*^9, 3.696077886709393*^9}, {
   3.696078823018544*^9, 3.69607885175454*^9}, {3.696078970322093*^9, 
   3.696079050810005*^9}, {3.697277098564064*^9, 3.697277116406493*^9}, 
   3.699003550952878*^9},ExpressionUUID->"b29f6f16-cbe4-40b6-b049-\
86ac8ad178de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sectorBoundaries", "=", 
  RowBox[{"SectorBoundariesFromDE", "[", "aFull", "]"}]}]], "Input",
 CellChangeTimes->{
  3.6911498852001*^9, {3.693305650591298*^9, 3.693305665871797*^9}, {
   3.6960772215083723`*^9, 3.696077229829014*^9}, 3.696077524134892*^9, {
   3.696139214641705*^9, 3.696139216484336*^9}, {3.697277099939343*^9, 
   3.697277126394043*^9}},ExpressionUUID->"6aa68d4e-a90e-4b11-bbaa-\
823628f50aee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"17", ",", "17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"19", ",", "19"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "21"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"22", ",", "23"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"24", ",", "25"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"26", ",", "26"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"27", ",", "27"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"28", ",", "28"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"29", ",", "31"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.696077524372157*^9, 3.696077673501416*^9, 3.6960790573409767`*^9, 
   3.6960796367955017`*^9, 3.6960802143098927`*^9, 3.6960813497482643`*^9, {
   3.696139217564657*^9, 3.69613922635879*^9}, 3.69668708696311*^9, 
   3.697277127554598*^9},ExpressionUUID->"802beb1a-ba9b-44fc-a00a-\
beb13535f889"]
}, Open  ]],

Cell[TextData[{
 "The computation is performed by calling the function ",
 StyleBox["RecursivelyTransformSectors", "Input"],
 " with the differential equation, the invariants and the sector boundaries. \
Furthermore, in the last argument the sectors are specified at which the \
computation starts and ends. Expect the following calculation to take about 8 \
minutes on a single core machine."
}], "Text",
 CellChangeTimes->{{3.696078206533189*^9, 3.6960782721993437`*^9}, {
   3.696079085615664*^9, 3.696079187426343*^9}, {3.697277101513153*^9, 
   3.6972771032501287`*^9}, 3.699003554656087*^9, {3.701177028863065*^9, 
   3.701177029853464*^9}, {3.701177118255269*^9, 
   3.701177124449923*^9}},ExpressionUUID->"ce21609c-9b5f-478f-bdd1-\
c68f4f4d64ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullResult", "=", 
   RowBox[{"RecursivelyTransformSectors", "[", 
    RowBox[{"aFull", ",", "invariants", ",", "sectorBoundaries", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "23"}], "}"}], ",", 
     RowBox[{"VerbosityLevel", "\[Rule]", "6"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.693305677897814*^9, 3.693305684248274*^9}, {
  3.69607724066322*^9, 3.696077275974866*^9}, {3.6960775479669733`*^9, 
  3.696077557263515*^9}, {3.696077735583702*^9, 3.696077742547769*^9}, {
  3.6960778007112293`*^9, 3.6960778009948387`*^9}, {3.696139247188531*^9, 
  3.696139260380649*^9}, {3.6966871190894613`*^9, 3.696687128252007*^9}, {
  3.697277105146195*^9, 3.697277129843115*^9}, {3.699266024888114*^9, 
  3.699266033633048*^9}},ExpressionUUID->"0d06c176-b56e-4fc3-acef-\
31c422edb9fb"],

Cell["\<\
The first entry of the result is the transformation and the second one is the \
resulting differential equation in canonical form.\
\>", "Text",
 CellChangeTimes->{{3.696077592651229*^9, 3.6960776263550377`*^9}, 
   3.699003565638345*^9},ExpressionUUID->"c8e0949c-5299-47bc-9217-\
9720564df8fe"],

Cell[BoxData[
 RowBox[{"trafo", "=", 
  RowBox[{"fullResult", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696077629858149*^9, 
  3.696077633494671*^9}},ExpressionUUID->"a6dea58c-1003-4516-9d26-\
73a3d98e5c6b"],

Cell[BoxData[
 RowBox[{"aEpsForm", "=", 
  RowBox[{"fullResult", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696077646596168*^9, 3.696077652680368*^9}, {
  3.6960777516170263`*^9, 3.6960777527273617`*^9}, {3.6960778144565496`*^9, 
  3.696077814693012*^9}},ExpressionUUID->"a76bc4bf-55d4-49d7-b23f-\
b24e9ba4a1bd"],

Cell[TextData[{
 "The alphabet can be extracted with the function ",
 StyleBox["ExtractIrreducibles", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.696080847707655*^9, 3.696080873881648*^9}, 
   3.6990035708578033`*^9},ExpressionUUID->"b8b8f507-95ed-4b88-9a87-\
c022ffa5ec59"],

Cell[BoxData[
 RowBox[{"alphabet", "=", 
  RowBox[{"ExtractIrreducibles", "[", "aEpsForm", "]"}]}]], "Input",
 CellChangeTimes->{{3.696080696528606*^9, 
  3.696080698414605*^9}},ExpressionUUID->"5756f3d4-432b-4285-b83e-\
1e6526d5c4e4"],

Cell[TextData[{
 "The \[Epsilon]-form may be verified with ",
 StyleBox["CheckEpsForm", "Input"],
 ":"
}], "Text",
 CellChangeTimes->{{3.6961387699863234`*^9, 3.696138806817401*^9}, {
  3.6990035746496887`*^9, 
  3.6990035753650417`*^9}},ExpressionUUID->"390a11fd-e675-4e3c-89ca-\
e517a33bcffe"],

Cell[BoxData[
 RowBox[{"CheckEpsForm", "[", 
  RowBox[{"aEpsForm", ",", "invariants", ",", "alphabet"}], "]"}]], "Input",
 CellChangeTimes->{{3.6960806709667187`*^9, 
  3.696080702697501*^9}},ExpressionUUID->"b8d5347f-9a98-4cbc-addf-\
56f89e39657a"],

Cell[TextData[{
 "The matrix-residues can be computed with ",
 StyleBox["CalculateDlogForm", "Input"]
}], "Text",
 CellChangeTimes->{{3.696081169233951*^9, 3.696081190936694*^9}, {
  3.6960812324031267`*^9, 
  3.6960812343743353`*^9}},ExpressionUUID->"3086cac7-39f7-49fc-8f27-\
ddd452b625e4"],

Cell[BoxData[
 RowBox[{"dlogForm", "=", 
  RowBox[{"CalculateDlogForm", "[", 
   RowBox[{"aEpsForm", ",", "invariants", ",", "alphabet"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.696080710908349*^9, 3.696080713759551*^9}, {
   3.6960807508212337`*^9, 3.696080761332637*^9}, {3.6960810360438633`*^9, 
   3.6960810444251757`*^9}, 
   3.696081390974917*^9},ExpressionUUID->"908c1db4-f1e1-498a-8bc1-\
76b35d34ea7a"],

Cell["which are readily cross-checked:", "Text",
 CellChangeTimes->{{3.69608119644376*^9, 
  3.6960812121758423`*^9}},ExpressionUUID->"4c1eb9a3-5cd2-42c3-b825-\
d7d3698c6b3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dlogForm", "[", 
       RowBox[{"[", "nLetter", "]"}], "]"}], "*", 
      RowBox[{"Log", "[", 
       RowBox[{"alphabet", "[", 
        RowBox[{"[", "nLetter", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"nLetter", ",", "1", ",", 
       RowBox[{"Length", "@", "alphabet"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6993584183108883`*^9, 
  3.699358466301895*^9}},ExpressionUUID->"d2132a42-9c5e-4af5-a371-\
bd5481747f48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"A", ",", "x"}], "]"}], "-", 
     RowBox[{"aEpsForm", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6993575816310987`*^9, 3.699357583903214*^9}, 
   3.6993576300446463`*^9, 
   3.699358372287375*^9},ExpressionUUID->"5c98a488-64e3-449a-9079-\
f2703d53dc8f"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.699357584300901*^9, 3.699357593987167*^9}, 
   3.699357633366939*^9, 3.6993583727397738`*^9, {3.699358455636476*^9, 
   3.699358469100733*^9}, 
   3.699358511146679*^9},ExpressionUUID->"e972988c-4818-48de-a79e-\
b8fc190c8030"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"A", ",", "y"}], "]"}], "-", 
     RowBox[{"aEpsForm", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6993575816310987`*^9, 3.699357583903214*^9}, 
   3.6993576300446463`*^9, 3.699358372287375*^9, {3.699358904033106*^9, 
   3.699358905784507*^9}},ExpressionUUID->"fc4d215a-a0e8-469a-a4e5-\
3842ac658a14"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.699357584300901*^9, 3.699357593987167*^9}, 
   3.699357633366939*^9, 3.6993583727397738`*^9, {3.699358455636476*^9, 
   3.699358469100733*^9}, 
   3.699358511146679*^9},ExpressionUUID->"0840d613-e1c5-4f39-8ba5-\
82affdbd4180"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"A", ",", "z"}], "]"}], "-", 
     RowBox[{"aEpsForm", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6993575816310987`*^9, 3.699357583903214*^9}, 
   3.6993576300446463`*^9, 3.699358372287375*^9, {3.699358910251924*^9, 
   3.699358912502986*^9}},ExpressionUUID->"fdf3ee7b-50d8-48ac-a391-\
246ebde25d2f"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.699357584300901*^9, 3.699357593987167*^9}, 
   3.699357633366939*^9, 3.6993583727397738`*^9, {3.699358455636476*^9, 
   3.699358469100733*^9}, 
   3.699358511146679*^9},ExpressionUUID->"90eaa4b9-450e-40fc-89d1-\
bf329f1c3afd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation of diagonal blocks", "Section",
 CellChangeTimes->{{3.6911545603380613`*^9, 3.691154563124282*^9}, {
   3.696077937466094*^9, 3.6960779420853024`*^9}, 
   3.69607982324893*^9},ExpressionUUID->"2e87694a-e99f-4e43-8f27-\
0dcfdae8271a"],

Cell[TextData[{
 "The function ",
 StyleBox["ExtractDiagonalBlock", "Input"],
 " extracts the diagonal block that is specified by its boundaries."
}], "Text",
 CellChangeTimes->{{3.696079663173656*^9, 
  3.696079732078588*^9}},ExpressionUUID->"5080b3a5-2b42-4db2-b3c0-\
1740b5ce0806"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nDiagonalBlock", "=", "23"}], ";"}]], "Input",
 CellChangeTimes->{{3.6911546349111032`*^9, 3.691154647635448*^9}, {
   3.693289765579372*^9, 3.6932897657037697`*^9}, {3.693289798121139*^9, 
   3.693289861943006*^9}, 3.69607795893613*^9, {3.696687246753523*^9, 
   3.69668724763173*^9}, {3.6972771447176323`*^9, 
   3.697277144812255*^9}},ExpressionUUID->"a94fa6f4-5617-48f9-92ce-\
8404fb172cac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{"ExtractDiagonalBlock", "[", 
   RowBox[{"aFull", ",", 
    RowBox[{"sectorBoundaries", "[", 
     RowBox[{"[", "nDiagonalBlock", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691154579796332*^9, 3.6911545979613047`*^9}, 
   3.6911546503012857`*^9, {3.696077955304044*^9, 3.696077956360448*^9}, {
   3.6966872507558804`*^9, 3.696687252557684*^9}, 3.6972771080766287`*^9, {
   3.6972771465483513`*^9, 
   3.697277147842684*^9}},ExpressionUUID->"f149bf71-02ca-448d-9e63-\
2523e98d35bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "eps"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "y", "+", 
            RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
           SuperscriptBox["x", "2"], " ", "y"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "eps"}], ")"}], " ", "x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "y"}], ")"}]}]}], 
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
           SuperscriptBox["x", "2"], " ", "y"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", "eps"}]}], ")"}], " ", "x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "y"}], ")"}]}]}], 
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "eps"}], ")"}], " ", "x"}], 
         RowBox[{"1", "+", 
          RowBox[{"x", " ", "y"}]}]]}], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"eps", " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"y", "-", "z"}], ")"}]}]]}], ",", 
       FractionBox[
        RowBox[{"eps", " ", "x", " ", "z"}], 
        RowBox[{
         RowBox[{"-", "y"}], "+", "z"}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y"}], "-", "z"}], ")"}]}], 
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{"y", "-", "z"}], ")"}]}]]}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x", "-", 
            RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "y", "+", 
            RowBox[{"3", " ", "x", " ", "y"}], "-", 
            RowBox[{"x", " ", 
             SuperscriptBox["y", "2"]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}], " ", "z"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"y", "-", "z"}], ")"}]}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["eps", 
        RowBox[{
         RowBox[{"x", " ", 
          SuperscriptBox["y", "2"]}], "-", 
         RowBox[{"x", " ", "y", " ", "z"}]}]], ",", 
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}]}]], ",", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"eps", "+", 
           RowBox[{"eps", " ", "x", " ", "z"}], "+", 
           RowBox[{"x", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "y"}], "+", "z"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}]}]]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"eps", " ", "x", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "y"}], ")"}], "2"]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}]}]], ",", 
       FractionBox[
        RowBox[{"eps", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "z"}], ")"}]}], "+", "z"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}]}]], ",", "0", ",", 
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}], " ", "z"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "y", "-", 
           RowBox[{"2", " ", "z"}]}], ")"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z"}]], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"eps", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "y"}], ")"}], "2"]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"y", "-", "z"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z"}]]}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "eps"}], "-", "z"}], ")"}], " ", "z"}], "+", 
         RowBox[{"y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "eps", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "z"}], ")"}]}], "+", "z"}], ")"}]}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y"}], "+", "z"}], ")"}]}]]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.691154598736055*^9, 3.6911546512233667`*^9, 3.691154730944628*^9, 
   3.691158548040571*^9, 3.691227949551581*^9, 3.69122980224294*^9, {
   3.693285667966941*^9, 3.6932856693344584`*^9}, 3.693289769279834*^9, {
   3.693289801342169*^9, 3.693289813436645*^9}, {3.693289843491727*^9, 
   3.693289862754446*^9}, 3.6960779617006207`*^9, 3.69607973562117*^9, 
   3.6966872550634403`*^9, 
   3.697277148609795*^9},ExpressionUUID->"1616ee2d-145f-4756-aaa2-\
4ff06ffd658e"]
}, Open  ]],

Cell[TextData[{
 "The transformation to a canonical basis is computed with ",
 StyleBox["TransformDiagonalBlock", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.696079852339901*^9, 3.696079862954475*^9}, {
   3.696080072620203*^9, 3.696080106458168*^9}, 
   3.699003724691757*^9},ExpressionUUID->"5d155fe6-3271-4879-a17a-\
1f60e83d2519"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"blockResult", "=", 
  RowBox[{"TransformDiagonalBlock", "[", 
   RowBox[{"a", ",", "invariants"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.69115460201665*^9, 3.691154610033132*^9}, {
   3.693289710786767*^9, 3.69328973620191*^9}, 3.696077970055726*^9, {
   3.696078014847673*^9, 
   3.696078017564032*^9}},ExpressionUUID->"07169d77-18c5-44b1-a654-\
63c7220380af"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Generating equations at order eps^0.\"\>"], "Print",
 CellChangeTimes->{{3.693289848251402*^9, 3.693289864888879*^9}, {
   3.69607797096386*^9, 3.696077978999517*^9}, 3.696078018452332*^9, 
   3.696080122819881*^9, 
   3.696687311625923*^9},ExpressionUUID->"c12b0fc8-6fb2-4386-84af-\
f4aa0038f7d5"],

Cell[BoxData["\<\"Solving equations at order eps^0.\"\>"], "Print",
 CellChangeTimes->{{3.693289848251402*^9, 3.693289864888879*^9}, {
   3.69607797096386*^9, 3.696077978999517*^9}, 3.696078018452332*^9, 
   3.696080122819881*^9, 
   3.696687324314686*^9},ExpressionUUID->"6dd6039e-fb86-44cb-8a78-\
b0f93efa86a2"],

Cell[BoxData["\<\"Checking whether series terminates.\"\>"], "Print",
 CellChangeTimes->{{3.693289848251402*^9, 3.693289864888879*^9}, {
   3.69607797096386*^9, 3.696077978999517*^9}, 3.696078018452332*^9, 
   3.696080122819881*^9, 
   3.6966873568154907`*^9},ExpressionUUID->"ceff84f9-c789-4209-9cc2-\
632c7e772943"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}], "2"]}]], ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["1", 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       FractionBox["2", 
        RowBox[{"x", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}], "2"], " ", "z"}]]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "eps", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "y", "+", 
              RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "x"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "eps", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "y", "+", 
              RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "x"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "eps", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "y", "+", 
              RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "x"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"x", " ", "y"}]}], ")"}]}]]}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "eps", " ", "x"}], 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}]]}], ",", 
         RowBox[{"-", 
          FractionBox["eps", 
           RowBox[{"y", "-", "z"}]]}], ",", 
         FractionBox[
          RowBox[{"2", " ", "eps"}], 
          RowBox[{
           RowBox[{"-", "y"}], "+", "z"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "y"}], "+", "z"}], ")"}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"y", "-", "z"}], ")"}]}]], ",", 
         FractionBox[
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "y", "+", 
             RowBox[{"3", " ", "x", " ", "y"}], "-", 
             RowBox[{"x", " ", 
              SuperscriptBox["y", "2"]}]}], ")"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", "y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "eps"}], 
           RowBox[{"y", "-", "z"}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"eps", " ", "z"}], 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["y", "2"]}], "-", 
           RowBox[{"2", " ", "y", " ", "z"}]}]], ",", 
         FractionBox[
          RowBox[{"eps", " ", "z"}], 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["y", "2"]}], "-", 
           RowBox[{"2", " ", "y", " ", "z"}]}]], ",", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"eps", "+", 
             RowBox[{"eps", " ", "x", " ", "z"}]}], ")"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"x", " ", "y"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"y", "-", "z"}], ")"}]}]]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox[
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}]}]], ",", 
         FractionBox[
          RowBox[{"2", " ", "eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "z"}], ")"}]}], "+", "z"}], ")"}]}], 
          
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}]}]], ",", "0", ",", 
         FractionBox[
          RowBox[{"2", " ", "eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}]}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "y", "-", 
             RowBox[{"2", " ", "z"}]}], ")"}]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"y", "-", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}]}]], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"eps", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"y", "-", "z"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "z"}], ")"}]}]]}], ",", 
         FractionBox[
          RowBox[{"2", " ", "eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "z"}], ")"}]}], "+", "z"}], ")"}]}], 
          
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y"}], "+", "z"}], ")"}]}]]}], "}"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6911546277571697`*^9, 3.691154771959179*^9, 3.6911585883384132`*^9, 
   3.691227993240039*^9, 3.6912298480786324`*^9, 3.693285714192841*^9, 
   3.693289731257333*^9, {3.69328976254885*^9, 3.693289867376404*^9}, {
   3.6960779710194407`*^9, 3.696077979052759*^9}, 3.696078018545086*^9, 
   3.69608012290068*^9, 
   3.6966873670641947`*^9},ExpressionUUID->"9fc39cd9-3f22-4418-a6cd-\
f0d6cd624f7e"]
}, Open  ]],

Cell["\<\
Again, the first entry is the transformation and the second one is the \
resulting differential equation in canonical form.\
\>", "Text",
 CellChangeTimes->{{3.696077988824342*^9, 
  3.696078044081538*^9}},ExpressionUUID->"3d9e048a-3baf-4104-bc40-\
096764f8b2cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trafoBlock", "=", 
  RowBox[{"blockResult", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696078057978483*^9, 
  3.69607806614333*^9}},ExpressionUUID->"6b19a999-da77-4c49-8b21-\
a38893bd3717"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"x", " ", "y"}]}], ")"}], "2"]}]], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox["2", 
      RowBox[{"x", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"x", " ", "y"}]}], ")"}], "2"], " ", "z"}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.696078058550915*^9, 3.696078066958527*^9}, 
   3.696080124082541*^9, 
   3.6966873817599*^9},ExpressionUUID->"ec89a019-8961-404f-b463-c8ce040ca562"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aBlockEpsForm", "=", 
  RowBox[{"blockResult", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696078061976901*^9, 
  3.696078074077878*^9}},ExpressionUUID->"1ad54ec2-c91e-4178-a553-\
26491a9d3cca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "eps", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "y", "+", 
            RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "eps", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "y", "+", 
            RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "eps", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "y", "+", 
            RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "eps", " ", "x"}], 
         RowBox[{"1", "+", 
          RowBox[{"x", " ", "y"}]}]]}], ",", 
       RowBox[{"-", 
        FractionBox["eps", 
         RowBox[{"y", "-", "z"}]]}], ",", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{
         RowBox[{"-", "y"}], "+", "z"}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "y"}], "+", "z"}], ")"}]}], 
        RowBox[{"y", " ", 
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}]}]], ",", 
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "y", "+", 
           RowBox[{"3", " ", "x", " ", "y"}], "-", 
           RowBox[{"x", " ", 
            SuperscriptBox["y", "2"]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "eps"}], 
         RowBox[{"y", "-", "z"}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"eps", " ", "z"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["y", "2"]}], "-", 
         RowBox[{"2", " ", "y", " ", "z"}]}]], ",", 
       FractionBox[
        RowBox[{"eps", " ", "z"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["y", "2"]}], "-", 
         RowBox[{"2", " ", "y", " ", "z"}]}]], ",", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"eps", "+", 
           RowBox[{"eps", " ", "x", " ", "z"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}]}]]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}]}]], ",", 
       FractionBox[
        RowBox[{"2", " ", "eps", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "z"}], ")"}]}], "+", "z"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z"}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}]}]], ",", "0", ",", 
       FractionBox[
        RowBox[{"2", " ", "eps", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "y", "-", 
           RowBox[{"2", " ", "z"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"y", "-", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}]}]], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "y"}], ")"}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"y", "-", "z"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "z"}], ")"}]}]]}], ",", 
       FractionBox[
        RowBox[{"2", " ", "eps", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "z"}], ")"}]}], "+", "z"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y"}], "+", "z"}], ")"}]}]]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6960780749046087`*^9, 3.696080124966794*^9, 
  3.696687384765883*^9},ExpressionUUID->"aaf49e99-e512-431d-8dca-\
7152fceca127"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{933, 771},
WindowMargins->{{7.5, Automatic}, {0, Automatic}},
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3c659fc3-1eee-45ca-85f2-770f1a37db39"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 68, "Section",ExpressionUUID->"1d25afd7-87e3-43c7-b503-e4c9ccd08f50"],
Cell[744, 27, 360, 10, 35, "Text",ExpressionUUID->"3ba1f511-81e0-41a8-8389-b526c059a9fc"],
Cell[1107, 39, 501, 9, 29, "Input",ExpressionUUID->"c9aa1880-e75e-4cc2-8843-e48a699b6fb1"],
Cell[1611, 50, 538, 12, 35, "Text",ExpressionUUID->"39db69e6-d780-43ab-b4ae-b87bade43406"],
Cell[2152, 64, 492, 9, 29, "Input",ExpressionUUID->"dfb154a4-6f67-46a1-810a-20bb4996167e"],
Cell[2647, 75, 294, 7, 35, "Text",ExpressionUUID->"40744f23-c3bb-4820-86b3-f144210b557e"],
Cell[2944, 84, 359, 8, 29, "Input",ExpressionUUID->"f418ade7-456a-4f10-95ce-cb52892d4355"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3340, 97, 179, 3, 68, "Section",ExpressionUUID->"3bb2b905-6a14-463d-9c3f-3ef95b1cccce"],
Cell[3522, 102, 560, 11, 58, "Text",ExpressionUUID->"b29f6f16-cbe4-40b6-b049-86ac8ad178de"],
Cell[CellGroupData[{
Cell[4107, 117, 437, 8, 29, "Input",ExpressionUUID->"6aa68d4e-a90e-4b11-bbaa-823628f50aee"],
Cell[4547, 127, 1760, 54, 55, "Output",ExpressionUUID->"802beb1a-ba9b-44fc-a00a-beb13535f889"]
}, Open  ]],
Cell[6322, 184, 754, 13, 81, "Text",ExpressionUUID->"ce21609c-9b5f-478f-bdd1-c68f4f4d64ad"],
Cell[7079, 199, 829, 15, 29, "Input",ExpressionUUID->"0d06c176-b56e-4fc3-acef-31c422edb9fb"],
Cell[7911, 216, 305, 6, 35, "Text",ExpressionUUID->"c8e0949c-5299-47bc-9217-9720564df8fe"],
Cell[8219, 224, 240, 6, 29, "Input",ExpressionUUID->"a6dea58c-1003-4516-9d26-73a3d98e5c6b"],
Cell[8462, 232, 344, 7, 29, "Input",ExpressionUUID->"a76bc4bf-55d4-49d7-b23f-b24e9ba4a1bd"],
Cell[8809, 241, 279, 7, 35, "Text",ExpressionUUID->"b8b8f507-95ed-4b88-9a87-c022ffa5ec59"],
Cell[9091, 250, 235, 5, 29, "Input",ExpressionUUID->"5756f3d4-432b-4285-b83e-1e6526d5c4e4"],
Cell[9329, 257, 295, 8, 35, "Text",ExpressionUUID->"390a11fd-e675-4e3c-89ca-e517a33bcffe"],
Cell[9627, 267, 249, 5, 29, "Input",ExpressionUUID->"b8d5347f-9a98-4cbc-addf-56f89e39657a"],
Cell[9879, 274, 292, 7, 35, "Text",ExpressionUUID->"3086cac7-39f7-49fc-8f27-ddd452b625e4"],
Cell[10174, 283, 414, 9, 34, "Input",ExpressionUUID->"908c1db4-f1e1-498a-8bc1-76b35d34ea7a"],
Cell[10591, 294, 175, 3, 33, "Text",ExpressionUUID->"4c1eb9a3-5cd2-42c3-b825-d7d3698c6b3c"],
Cell[10769, 299, 571, 17, 34, "Input",ExpressionUUID->"d2132a42-9c5e-4af5-a371-bd5481747f48"],
Cell[CellGroupData[{
Cell[11365, 320, 445, 12, 34, "Input",ExpressionUUID->"5c98a488-64e3-449a-9079-f2703d53dc8f"],
Cell[11813, 334, 299, 6, 32, "Output",ExpressionUUID->"e972988c-4818-48de-a79e-b8fc190c8030"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12149, 345, 491, 12, 34, "Input",ExpressionUUID->"fc4d215a-a0e8-469a-a4e5-3842ac658a14"],
Cell[12643, 359, 299, 6, 32, "Output",ExpressionUUID->"0840d613-e1c5-4f39-8ba5-82affdbd4180"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12979, 370, 491, 12, 34, "Input",ExpressionUUID->"fdf3ee7b-50d8-48ac-a391-246ebde25d2f"],
Cell[13473, 384, 299, 6, 32, "Output",ExpressionUUID->"90eaa4b9-450e-40fc-89d1-bf329f1c3afd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13821, 396, 254, 4, 65, "Section",ExpressionUUID->"2e87694a-e99f-4e43-8f27-0dcfdae8271a"],
Cell[14078, 402, 284, 7, 33, "Text",ExpressionUUID->"5080b3a5-2b42-4db2-b3c0-1740b5ce0806"],
Cell[14365, 411, 430, 8, 34, "Input",ExpressionUUID->"a94fa6f4-5617-48f9-92ce-8404fb172cac"],
Cell[CellGroupData[{
Cell[14820, 423, 539, 11, 34, "Input",ExpressionUUID->"f149bf71-02ca-448d-9e63-2523e98d35bd"],
Cell[15362, 436, 10037, 306, 385, "Output",ExpressionUUID->"1616ee2d-145f-4756-aaa2-4ff06ffd658e"]
}, Open  ]],
Cell[25414, 745, 339, 8, 33, "Text",ExpressionUUID->"5d155fe6-3271-4879-a17a-1f60e83d2519"],
Cell[CellGroupData[{
Cell[25778, 757, 388, 8, 32, "Input",ExpressionUUID->"07169d77-18c5-44b1-a654-63c7220380af"],
Cell[CellGroupData[{
Cell[26191, 769, 316, 5, 23, "Print",ExpressionUUID->"c12b0fc8-6fb2-4386-84af-f4aa0038f7d5"],
Cell[26510, 776, 313, 5, 23, "Print",ExpressionUUID->"6dd6039e-fb86-44cb-8a78-b0f93efa86a2"],
Cell[26826, 783, 317, 5, 23, "Print",ExpressionUUID->"ceff84f9-c789-4209-9cc2-632c7e772943"]
}, Open  ]],
Cell[27158, 791, 8610, 261, 281, "Output",ExpressionUUID->"9fc39cd9-3f22-4418-a6cd-f0d6cd624f7e"]
}, Open  ]],
Cell[35783, 1055, 273, 6, 33, "Text",ExpressionUUID->"3d9e048a-3baf-4104-bc40-096764f8b2cd"],
Cell[CellGroupData[{
Cell[36081, 1065, 245, 6, 32, "Input",ExpressionUUID->"6b19a999-da77-4c49-8b21-a38893bd3717"],
Cell[36329, 1073, 1272, 41, 51, "Output",ExpressionUUID->"ec89a019-8961-404f-b463-c8ce040ca562"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37638, 1119, 249, 6, 32, "Input",ExpressionUUID->"1ad54ec2-c91e-4178-a553-26491a9d3cca"],
Cell[37890, 1127, 6700, 214, 175, "Output",ExpressionUUID->"aaf49e99-e512-431d-8dca-7152fceca127"]
}, Open  ]]
}, Open  ]]
}
]
*)

