(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47509,       1387]
NotebookOptionsPosition[     43182,       1314]
NotebookOutlinePosition[     43572,       1330]
CellTagsIndexPosition[     43529,       1327]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Section",
 CellChangeTimes->{{3.6911546832731037`*^9, 
  3.691154685889964*^9}},ExpressionUUID->"d3085d44-36c5-4b10-bb3f-\
5b9ad2d490fa"],

Cell[TextData[{
 "The ",
 StyleBox["CANONICA",
  FontSlant->"Italic"],
 " package is loaded with"
}], "Text",
 CellChangeTimes->{{3.69607689945234*^9, 3.6960769596267223`*^9}, {
   3.6960801419254007`*^9, 3.696080164699592*^9}, 3.698996329730905*^9, {
   3.6998607937681637`*^9, 
   3.699860794385149*^9}},ExpressionUUID->"25654d6f-4388-4a21-8738-\
b113e0a920d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<../../src/CANONICA.m\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.691149699778109*^9, 3.691149704040081*^9}, {
   3.6911498683750896`*^9, 3.691149868700045*^9}, {3.6911547154576597`*^9, 
   3.691154716998674*^9}, 3.69328564146728*^9, {3.696076856871777*^9, 
   3.6960768569755087`*^9}, {3.696077506119692*^9, 3.696077506470064*^9}, {
   3.696684400819227*^9, 
   3.6966844070384893`*^9}},ExpressionUUID->"73dc849a-c450-46f4-bb25-\
3c3afa01f0de"],

Cell[TextData[{
 "The differential equation is loaded from the file ",
 "./K4IntegralDEQ.m ",
 "and assigned to the symbol ",
 StyleBox["aFull", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.6960769778850393`*^9, 3.696077027368045*^9}, {
   3.696077097086562*^9, 3.696077102039546*^9}, {3.696077911738266*^9, 
   3.6960779134048*^9}, {3.6960801923947983`*^9, 3.696080194836356*^9}, 
   3.698996338315629*^9, {3.699350146365981*^9, 
   3.6993501560976763`*^9}},ExpressionUUID->"4e2250de-d6cd-49bc-903d-\
2a216de65604"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<./K4IntegralDEQ.m\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.691149728152817*^9, 3.69114973305509*^9}, {
  3.691149870686261*^9, 3.691149871025222*^9}, {3.6911547225339823`*^9, 
  3.691154722759338*^9}, {3.6933055840069427`*^9, 3.693305597511188*^9}, {
  3.6960775131155663`*^9, 3.696077516844385*^9}, {3.69608179473415*^9, 
  3.696081797276437*^9}},ExpressionUUID->"1cefc52e-5287-4851-8f95-\
5213ec4772bb"],

Cell["\<\
The invariants on which the differential equation depends need to be \
specified in a list.\
\>", "Text",
 CellChangeTimes->{{3.6960771292616873`*^9, 3.6960771586581078`*^9}, 
   3.698996343177816*^9, {3.699002082124138*^9, 3.699002103604444*^9}, {
   3.699350165062737*^9, 
   3.699350179586586*^9}},ExpressionUUID->"9aa309a8-063c-42e3-9f30-\
2d61c133a6c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"invariants", "=", 
   RowBox[{"{", "x", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691149750694868*^9, 3.6911497615636168`*^9}, {
  3.693305619553362*^9, 
  3.6933056200087633`*^9}},ExpressionUUID->"c3ad4bfe-ecfb-403f-90bd-\
3212d40be787"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation of the full topology", "Section",
 CellChangeTimes->{{3.69607787109216*^9, 
  3.696077876718933*^9}},ExpressionUUID->"cf368356-a222-40e0-9a1c-\
962d83df6266"],

Cell[TextData[{
 "In order to use the recursion over sectors, the boundaries of the sectors \
need to be specified. This information can be extracted from the differential \
equation with the function ",
 StyleBox["SectorBoundariesFromDE", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.696077882533826*^9, 3.696077886709393*^9}, {
   3.696078823018544*^9, 3.69607885175454*^9}, {3.696078970322093*^9, 
   3.696079050810005*^9}, 3.6972753779048023`*^9, 3.697275752489098*^9, 
   3.6989963498696947`*^9},ExpressionUUID->"b9a9e95e-9ded-4e1d-934b-\
3f7b16bc7d92"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sectorBoundaries", "=", 
  RowBox[{"SectorBoundariesFromDE", "[", "aFull", "]"}]}]], "Input",
 CellChangeTimes->{
  3.6911498852001*^9, {3.693305650591298*^9, 3.693305665871797*^9}, {
   3.6960772215083723`*^9, 3.696077229829014*^9}, 3.696077524134892*^9, {
   3.697275347571289*^9, 
   3.697275350641815*^9}},ExpressionUUID->"6d7cdb00-e415-4756-a475-\
8de6d7f2e84c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "10"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.696077524372157*^9, 3.696077673501416*^9, 
  3.6960790573409767`*^9, 3.6960796367955017`*^9, 3.6960802143098927`*^9, 
  3.6960813497482643`*^9, 3.696081801325259*^9, 3.696684411681988*^9, 
  3.697275388306241*^9, 
  3.699002126128249*^9},ExpressionUUID->"a09c7460-6e34-46c4-a5d5-\
32e2e0f29395"]
}, Open  ]],

Cell[TextData[{
 "The computation is performed by calling the function ",
 StyleBox["RecursivelyTransformSectors", "Input"],
 " with the differential equation, the invariants and the sector boundaries. \
Furthermore, in the last argument the sectors are specified at which the \
computation starts and ends. Expect the following calculation to take about \
10 minutes on a single core machine."
}], "Text",
 CellChangeTimes->{{3.696078206533189*^9, 3.6960782721993437`*^9}, {
   3.696079085615664*^9, 3.696079187426343*^9}, {3.697275360852824*^9, 
   3.697275362640212*^9}, 3.698996374092617*^9, {3.701176550290978*^9, 
   3.7011765726345377`*^9}},ExpressionUUID->"92919e03-04ec-4f00-9ecb-\
a14b90683fc1"],

Cell[BoxData[
 RowBox[{"fullResult", "=", 
  RowBox[{"RecursivelyTransformSectors", "[", 
   RowBox[{"aFull", ",", "invariants", ",", "sectorBoundaries", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.693305677897814*^9, 3.693305684248274*^9}, {
   3.69607724066322*^9, 3.696077275974866*^9}, {3.6960775479669733`*^9, 
   3.696077557263515*^9}, {3.696077735583702*^9, 3.696077742547769*^9}, {
   3.6960778007112293`*^9, 3.6960778009948387`*^9}, 3.696081805021873*^9, 
   3.697275364440247*^9},ExpressionUUID->"57add4d9-2228-44a6-a058-\
7aafe188c1f1"],

Cell["\<\
The first entry of the result is the transformation and the second one is the \
resulting differential equation in canonical form.\
\>", "Text",
 CellChangeTimes->{{3.696077592651229*^9, 3.6960776263550377`*^9}, 
   3.698996401350511*^9},ExpressionUUID->"e8175397-4afb-46bf-adb9-\
355e25564958"],

Cell[BoxData[
 RowBox[{"trafo", "=", 
  RowBox[{"fullResult", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696077629858149*^9, 
  3.696077633494671*^9}},ExpressionUUID->"41cad385-01cb-4f94-8be6-\
8a9ffa2e6691"],

Cell[BoxData[
 RowBox[{"aEpsForm", "=", 
  RowBox[{"fullResult", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696077646596168*^9, 3.696077652680368*^9}, {
  3.6960777516170263`*^9, 3.6960777527273617`*^9}, {3.6960778144565496`*^9, 
  3.696077814693012*^9}},ExpressionUUID->"adad6255-c700-4aaa-ba77-\
bdb90c750204"],

Cell[TextData[{
 "The alphabet can be extracted with the function ",
 StyleBox["ExtractIrreducibles", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.696080847707655*^9, 3.696080873881648*^9}, 
   3.698996406328382*^9},ExpressionUUID->"e4c9175c-010c-47aa-88ae-\
65ec18640de3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphabet", "=", 
  RowBox[{"ExtractIrreducibles", "[", "aEpsForm", "]"}]}]], "Input",
 CellChangeTimes->{{3.696080696528606*^9, 
  3.696080698414605*^9}},ExpressionUUID->"41a445cb-0d93-4f7a-bddc-\
db05cd5dd823"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", 
   RowBox[{"1", "+", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6960807450681753`*^9, 3.6960813853535147`*^9, 
  3.696082359135911*^9, 3.696684965747665*^9, 
  3.697275932369513*^9},ExpressionUUID->"4d63ef49-e314-4062-8ae7-\
475140f6e4f8"]
}, Open  ]],

Cell[TextData[{
 "The \[Epsilon]-form may be verified with ",
 StyleBox["CheckEpsForm", "Input"],
 ":"
}], "Text",
 CellChangeTimes->{{3.6961387699863234`*^9, 3.696138806817401*^9}, {
  3.6989964098267612`*^9, 
  3.698996410775545*^9}},ExpressionUUID->"efc217e2-5c3a-494c-ac0e-\
6c9e99d32a4b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CheckEpsForm", "[", 
  RowBox[{"aEpsForm", ",", "invariants", ",", "alphabet"}], "]"}]], "Input",
 CellChangeTimes->{{3.6960806709667187`*^9, 
  3.696080702697501*^9}},ExpressionUUID->"ef5f080b-3b1b-4edc-98ab-\
062f3ea91667"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.696080713870318*^9, 3.696080747772181*^9, 
  3.696080882384721*^9, 3.696081386576948*^9, 3.6960823608075457`*^9, 
  3.6966849670918627`*^9, 
  3.697275933230475*^9},ExpressionUUID->"9748332c-fea7-4fe9-8661-\
ea278651f4f4"]
}, Open  ]],

Cell[TextData[{
 "The matrix-residues can be computed with ",
 StyleBox["CalculateDlogForm", "Input"]
}], "Text",
 CellChangeTimes->{{3.696081169233951*^9, 3.696081190936694*^9}, {
  3.6960812324031267`*^9, 
  3.6960812343743353`*^9}},ExpressionUUID->"0a5b9b6f-c415-4913-b976-\
7c45dd4ca582"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dlogForm", "=", 
  RowBox[{"CalculateDlogForm", "[", 
   RowBox[{"aEpsForm", ",", "invariants", ",", "alphabet"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.696080710908349*^9, 3.696080713759551*^9}, {
   3.6960807508212337`*^9, 3.696080761332637*^9}, {3.6960810360438633`*^9, 
   3.6960810444251757`*^9}, 
   3.696081390974917*^9},ExpressionUUID->"593a8baa-6640-467f-8185-\
46cee85307ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "3"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", "eps", ",", "eps", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{"4", " ", "eps"}], ",", 
       RowBox[{"30", " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "eps", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{"2", " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "90"}], " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "eps", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "eps", ",", "eps", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "16"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "5"}], " ", "eps"}], ",", 
       RowBox[{"30", " ", "eps"}], ",", 
       RowBox[{"390", " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"27", " ", "eps"}], "4"]}], ",", "0", ",", "0", ",", "eps", 
       ",", 
       RowBox[{
        RowBox[{"-", "16"}], " ", "eps"}], ",", "0", ",", 
       RowBox[{"32", " ", "eps"}], ",", 
       RowBox[{"496", " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "eps", ",", 
       "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "31"}], " ", "eps"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "3"}], " ", "eps"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{"2", " ", "eps"}], ",", 
       RowBox[{"2", " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "30"}], " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "eps", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"27", " ", "eps"}], "2"]}], ",", 
       FractionBox[
        RowBox[{"27", " ", "eps"}], "2"], ",", "0", ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "eps"}], ",", 
       RowBox[{"2", " ", "eps"}], ",", 
       RowBox[{"2", " ", "eps"}], ",", "0", ",", 
       RowBox[{"30", " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"27", " ", "eps"}], "8"], ",", 
       FractionBox[
        RowBox[{"27", " ", "eps"}], "8"], ",", 
       FractionBox[
        RowBox[{"27", " ", "eps"}], "4"], ",", "eps", ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{"2", " ", "eps"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "7"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "104"}], " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "54"}], " ", "eps"}], ",", 
       FractionBox[
        RowBox[{"189", " ", "eps"}], "4"], ",", "0", ",", "0", ",", 
       RowBox[{"-", "eps"}], ",", "0", ",", 
       RowBox[{"16", " ", "eps"}], ",", 
       RowBox[{"16", " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "16"}], " ", "eps"}], ",", 
       RowBox[{"16", " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"351", " ", "eps"}], "8"]}], ",", 
       FractionBox[
        RowBox[{"189", " ", "eps"}], "4"], ",", 
       FractionBox[
        RowBox[{"27", " ", "eps"}], "4"], ",", "eps", ",", "0", ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{"16", " ", "eps"}], ",", 
       RowBox[{"14", " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "21"}], " ", "eps"}], ",", 
       RowBox[{
        RowBox[{"-", "90"}], " ", "eps"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"27", " ", "eps"}], "8"], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"27", " ", "eps"}], "8"]}], ",", "0", ",", "0", ",", "0", 
       ",", "0", ",", 
       RowBox[{"-", "eps"}], ",", 
       RowBox[{"-", "eps"}], ",", "eps", ",", 
       RowBox[{"-", "eps"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.696081391361837*^9, 3.696082362961844*^9, 
  3.696684968733007*^9, 
  3.69727593409098*^9},ExpressionUUID->"0986a35e-7f66-47a8-9aec-9ff945b8ffa3"]
}, Open  ]],

Cell["which are readily cross-checked:", "Text",
 CellChangeTimes->{{3.69608119644376*^9, 
  3.6960812121758423`*^9}},ExpressionUUID->"7d12076b-3b18-49a8-b6eb-\
bf8e4ef4d6b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dlogForm", "[", 
       RowBox[{"[", "nLetter", "]"}], "]"}], "*", 
      RowBox[{"Log", "[", 
       RowBox[{"alphabet", "[", 
        RowBox[{"[", "nLetter", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"nLetter", ",", "1", ",", 
       RowBox[{"Length", "@", "alphabet"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6993584183108883`*^9, 
  3.699358466301895*^9}},ExpressionUUID->"bcece7b5-4e11-4849-8313-\
74a796753905"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"A", ",", "x"}], "]"}], "-", 
     RowBox[{"aEpsForm", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6993575816310987`*^9, 3.699357583903214*^9}, 
   3.6993576300446463`*^9, 
   3.699358372287375*^9},ExpressionUUID->"1e4e4d9b-9549-4f86-b889-\
af933e7a4917"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.699357584300901*^9, 3.699357593987167*^9}, 
   3.699357633366939*^9, 3.6993583727397738`*^9, {3.699358455636476*^9, 
   3.699358469100733*^9}, 
   3.699358511146679*^9},ExpressionUUID->"0da4d0c5-ccbf-4ebc-9e05-\
618a36c0ad34"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation of diagonal blocks", "Section",
 CellChangeTimes->{{3.6911545603380613`*^9, 3.691154563124282*^9}, {
   3.696077937466094*^9, 3.6960779420853024`*^9}, 
   3.69607982324893*^9},ExpressionUUID->"45afcec4-ad44-4827-9f50-\
1c80fb161aa6"],

Cell[TextData[{
 "The function ",
 StyleBox["ExtractDiagonalBlock", "Input"],
 " extracts the diagonal block that is specified by its boundaries."
}], "Text",
 CellChangeTimes->{{3.696079663173656*^9, 
  3.696079732078588*^9}},ExpressionUUID->"ba989ed0-1f5f-44b6-9eae-\
038ac0ecf8fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nDiagonalBlock", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.6911546349111032`*^9, 3.691154647635448*^9}, {
   3.693289765579372*^9, 3.6932897657037697`*^9}, {3.693289798121139*^9, 
   3.693289861943006*^9}, 3.69607795893613*^9, 
   3.696082195914112*^9},ExpressionUUID->"a0f1b1b7-e000-4f18-9254-\
003ddac82b24"],

Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{"ExtractDiagonalBlock", "[", 
   RowBox[{"aFull", ",", 
    RowBox[{"sectorBoundaries", "[", 
     RowBox[{"[", "nDiagonalBlock", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691154579796332*^9, 3.6911545979613047`*^9}, 
   3.6911546503012857`*^9, {3.696077955304044*^9, 3.696077956360448*^9}, 
   3.697275375320606*^9},ExpressionUUID->"5980b7e5-3c4e-4bae-b68e-\
4820524b9e84"],

Cell[TextData[{
 "The transformation to a canonical basis is computed with ",
 StyleBox["TransformDiagonalBlock", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.696079852339901*^9, 3.696079862954475*^9}, {
   3.696080072620203*^9, 3.696080106458168*^9}, 
   3.698996451869114*^9},ExpressionUUID->"8f0d3af7-83d4-4510-899a-\
0a96790251a1"],

Cell[BoxData[
 RowBox[{"blockResult", "=", 
  RowBox[{"TransformDiagonalBlock", "[", 
   RowBox[{"a", ",", "invariants"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.69115460201665*^9, 3.691154610033132*^9}, {
   3.693289710786767*^9, 3.69328973620191*^9}, 3.696077970055726*^9, {
   3.696078014847673*^9, 
   3.696078017564032*^9}},ExpressionUUID->"594bf9de-ef9e-47a9-b88a-\
80deb817588f"],

Cell["\<\
Again, the first entry is the transformation and the second one is the \
resulting differential equation in canonical form.\
\>", "Text",
 CellChangeTimes->{{3.696077988824342*^9, 
  3.696078044081538*^9}},ExpressionUUID->"f7775add-c9e9-449c-8818-\
e088dbc73ae7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trafoBlock", "=", 
  RowBox[{"blockResult", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696078057978483*^9, 
  3.69607806614333*^9}},ExpressionUUID->"439b50f9-cc6e-4044-b1e5-\
d2060ebb56cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", 
       RowBox[{"7", " ", "eps"}], "+", 
       RowBox[{"10", " ", 
        SuperscriptBox["eps", "2"]}]}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"8", " ", "eps"}]}]], ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"1", "-", 
       RowBox[{"7", " ", "eps"}], "+", 
       RowBox[{"10", " ", 
        SuperscriptBox["eps", "2"]}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]], ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"1", "-", 
        RowBox[{"7", " ", "eps"}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["eps", "2"]}]}], 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", 
        RowBox[{"8", " ", "eps", " ", "x"}]}]]}], ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["eps", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}]}], "-", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"7", " ", "x"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["eps", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x"}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"3", " ", "x"}], "+", 
            SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "eps"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"5", " ", "eps"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["eps", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}]}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"8", "+", 
            RowBox[{"8", " ", "x"}], "+", 
            SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "eps"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"5", " ", "eps"}]}], ")"}], " ", "x"}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["eps", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"9", " ", "eps"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["eps", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", "x"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"9", " ", "eps"}], "+", 
          RowBox[{"10", " ", 
           SuperscriptBox["eps", "2"]}]}], ")"}]}]]}], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["eps", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "x"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["eps", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"7", " ", "eps"}]}], ")"}], " ", "x"}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"5", " ", "eps"}]}], ")"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"eps", " ", 
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{"7", " ", "eps", " ", "x"}], "-", 
          RowBox[{"112", " ", 
           SuperscriptBox["eps", "2"], " ", "x"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["eps", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "30"}], "+", 
             RowBox[{"79", " ", "x"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"9", " ", "eps"}], "+", 
          RowBox[{"10", " ", 
           SuperscriptBox["eps", "2"]}]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["eps", "3"], " ", "x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "x", "+", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"4", " ", "x"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["eps", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "x"}], ")"}]}]}], ")"}], " ", "x"}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "eps"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"5", " ", "eps"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["eps", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "x"}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"9", " ", "eps"}], "+", 
          RowBox[{"10", " ", 
           SuperscriptBox["eps", "2"]}]}], ")"}]}]]}], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["eps", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"6", " ", "eps"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["eps", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", "x"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"8", " ", "eps"}]}], ")"}], " ", 
       SuperscriptBox["eps", "3"], " ", "x"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["eps", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "x"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", "eps"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"5", " ", "eps"}]}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{"eps", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "x"}], "-", 
         RowBox[{"124", " ", 
          SuperscriptBox["eps", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "x"}], ")"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["eps", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"124", "+", 
            RowBox[{"7", " ", "x"}]}], ")"}]}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{"62", "+", 
            RowBox[{"44", " ", "x"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["eps", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}]}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x", "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["eps", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "x"}], "+", 
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"6", " ", "x"}], "+", 
             SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "eps"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"5", " ", "eps"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["eps", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x", "+", 
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "-", "x", "+", 
             SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "eps"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"5", " ", "eps"}]}], ")"}], " ", "x"}]]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["eps", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["eps", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "8"}], "+", "x"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "eps"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["eps", "2"]}]}], ")"}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["eps", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"9", " ", "eps", " ", "x"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["eps", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"8", " ", "x"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"9", " ", "eps"}], "+", 
          RowBox[{"10", " ", 
           SuperscriptBox["eps", "2"]}]}], ")"}]}]]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["eps", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"7", " ", "eps"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"5", " ", "eps"}]}], ")"}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"eps", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x", "+", 
          RowBox[{"eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "23"}], "+", 
             RowBox[{"7", " ", "x"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["eps", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "79"}], "+", 
             RowBox[{"56", " ", "x"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["eps", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "262"}], "+", 
             RowBox[{"218", " ", "x"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", "eps"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"9", " ", "eps"}], "+", 
          RowBox[{"10", " ", 
           SuperscriptBox["eps", "2"]}]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "eps"}]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"4", " ", "eps"}]}], ")"}], "2"]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.696078058550915*^9, 3.696078066958527*^9}, 
   3.696080124082541*^9, 
   3.696082991693705*^9},ExpressionUUID->"e8654515-86a3-4387-a606-\
c4394f6b24e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aBlockEpsForm", "=", 
  RowBox[{"blockResult", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696078061976901*^9, 3.696078074077878*^9}, {
  3.6960830019314613`*^9, 
  3.696083013791329*^9}},ExpressionUUID->"c3e98fe5-0b8e-4981-a4bf-\
a7fc4ddd064c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "eps"}], "+", 
         RowBox[{"4", " ", "eps", " ", "x"}]}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", 
      FractionBox["eps", 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      FractionBox["eps", 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", 
      FractionBox[
       RowBox[{"4", " ", "eps"}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      FractionBox[
       RowBox[{"30", " ", "eps"}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["eps", "x"], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "x"}], ")"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
      RowBox[{"-", 
       FractionBox["eps", "x"]}], ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], "x"], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "eps"}], "x"]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "eps"}], "x"]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"90", " ", "eps"}], "x"]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["eps", 
        RowBox[{"1", "+", "x"}]]}], ",", 
      RowBox[{"-", 
       FractionBox["eps", 
        RowBox[{"1", "+", "x"}]]}], ",", 
      FractionBox[
       RowBox[{"eps", "-", 
        RowBox[{"eps", " ", "x"}]}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", "0", ",", 
      FractionBox[
       RowBox[{"30", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["eps", 
       RowBox[{"1", "+", "x"}]], ",", 
      RowBox[{"-", 
       FractionBox["eps", 
        RowBox[{"1", "+", "x"}]]}], ",", 
      RowBox[{"-", 
       FractionBox["eps", 
        RowBox[{"1", "+", "x"}]]}], ",", 
      FractionBox[
       RowBox[{"2", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"7", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"104", " ", "eps"}], 
        RowBox[{"1", "+", "x"}]]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["eps", "x"], ",", 
      FractionBox["eps", 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", "0", ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"16", " ", "eps"}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", 
      FractionBox[
       RowBox[{"eps", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"11", " ", "x"}]}], ")"}]}], 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"30", " ", "eps"}], "+", 
        RowBox[{"14", " ", "eps", " ", "x"}]}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"390", " ", "eps"}], "+", 
        RowBox[{"406", " ", "eps", " ", "x"}]}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["eps", 
       RowBox[{"1", "+", "x"}]], ",", "0", ",", 
      FractionBox["eps", 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"16", " ", "eps"}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}], ",", 
      FractionBox[
       RowBox[{"14", " ", "eps"}], 
       RowBox[{"1", "+", "x"}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"32", " ", "eps"}], "+", 
        RowBox[{"11", " ", "eps", " ", "x"}]}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"496", " ", "eps"}], "+", 
        RowBox[{"406", " ", "eps", " ", "x"}]}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      FractionBox["eps", 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]], ",", 
      RowBox[{"-", 
       FractionBox["eps", 
        RowBox[{"1", "+", "x"}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"eps", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "x"}], ")"}]}], 
        RowBox[{"x", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"31", " ", "eps"}], "+", 
         RowBox[{"32", " ", "eps", " ", "x"}]}], 
        RowBox[{"x", "+", 
         SuperscriptBox["x", "2"]}]]}]}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6960780749046087`*^9, 3.696080124966794*^9, {3.696082991750581*^9, 
   3.696083014203794*^9}},ExpressionUUID->"c067dde3-c761-4653-a3cd-\
0dd5023125ca"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{933, 771},
WindowMargins->{{7.5, Automatic}, {0, Automatic}},
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d760db6c-78a7-42c4-9667-5d82098e1271"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 68, "Section",ExpressionUUID->"d3085d44-36c5-4b10-bb3f-5b9ad2d490fa"],
Cell[744, 27, 363, 10, 35, "Text",ExpressionUUID->"25654d6f-4388-4a21-8738-b113e0a920d5"],
Cell[1110, 39, 503, 9, 29, "Input",ExpressionUUID->"73dc849a-c450-46f4-bb25-3c3afa01f0de"],
Cell[1616, 50, 520, 12, 35, "Text",ExpressionUUID->"4e2250de-d6cd-49bc-903d-2a216de65604"],
Cell[2139, 64, 467, 8, 29, "Input",ExpressionUUID->"1cefc52e-5287-4851-8f95-5213ec4772bb"],
Cell[2609, 74, 368, 8, 35, "Text",ExpressionUUID->"9aa309a8-063c-42e3-9f30-2d61c133a6c1"],
Cell[2980, 84, 279, 7, 29, "Input",ExpressionUUID->"c3ad4bfe-ecfb-403f-90bd-3212d40be787"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3296, 96, 179, 3, 68, "Section",ExpressionUUID->"cf368356-a222-40e0-9a1c-962d83df6266"],
Cell[3478, 101, 562, 11, 58, "Text",ExpressionUUID->"b9a9e95e-9ded-4e1d-934b-3f7b16bc7d92"],
Cell[CellGroupData[{
Cell[4065, 116, 391, 8, 29, "Input",ExpressionUUID->"6d7cdb00-e415-4756-a475-8de6d7f2e84c"],
Cell[4459, 126, 607, 16, 33, "Output",ExpressionUUID->"a09c7460-6e34-46c4-a5d5-32e2e0f29395"]
}, Open  ]],
Cell[5081, 145, 705, 12, 81, "Text",ExpressionUUID->"92919e03-04ec-4f00-9ecb-a14b90683fc1"],
Cell[5789, 159, 607, 11, 29, "Input",ExpressionUUID->"57add4d9-2228-44a6-a058-7aafe188c1f1"],
Cell[6399, 172, 305, 6, 35, "Text",ExpressionUUID->"e8175397-4afb-46bf-adb9-355e25564958"],
Cell[6707, 180, 240, 6, 29, "Input",ExpressionUUID->"41cad385-01cb-4f94-8be6-8a9ffa2e6691"],
Cell[6950, 188, 344, 7, 29, "Input",ExpressionUUID->"adad6255-c700-4aaa-ba77-bdb90c750204"],
Cell[7297, 197, 277, 7, 35, "Text",ExpressionUUID->"e4c9175c-010c-47aa-88ae-65ec18640de3"],
Cell[CellGroupData[{
Cell[7599, 208, 235, 5, 29, "Input",ExpressionUUID->"41a445cb-0d93-4f7a-bddc-db05cd5dd823"],
Cell[7837, 215, 294, 7, 33, "Output",ExpressionUUID->"4d63ef49-e314-4062-8ae7-475140f6e4f8"]
}, Open  ]],
Cell[8146, 225, 293, 8, 35, "Text",ExpressionUUID->"efc217e2-5c3a-494c-ac0e-6c9e99d32a4b"],
Cell[CellGroupData[{
Cell[8464, 237, 249, 5, 29, "Input",ExpressionUUID->"ef5f080b-3b1b-4edc-98ab-062f3ea91667"],
Cell[8716, 244, 275, 5, 32, "Output",ExpressionUUID->"9748332c-fea7-4fe9-8661-ea278651f4f4"]
}, Open  ]],
Cell[9006, 252, 292, 7, 33, "Text",ExpressionUUID->"0a5b9b6f-c415-4913-b976-7c45dd4ca582"],
Cell[CellGroupData[{
Cell[9323, 263, 414, 9, 34, "Input",ExpressionUUID->"593a8baa-6640-467f-8185-46cee85307ec"],
Cell[9740, 274, 6301, 176, 426, "Output",ExpressionUUID->"0986a35e-7f66-47a8-9aec-9ff945b8ffa3"]
}, Open  ]],
Cell[16056, 453, 175, 3, 33, "Text",ExpressionUUID->"7d12076b-3b18-49a8-b6eb-bf8e4ef4d6b9"],
Cell[16234, 458, 571, 17, 34, "Input",ExpressionUUID->"bcece7b5-4e11-4849-8313-74a796753905"],
Cell[CellGroupData[{
Cell[16830, 479, 445, 12, 34, "Input",ExpressionUUID->"1e4e4d9b-9549-4f86-b889-af933e7a4917"],
Cell[17278, 493, 299, 6, 32, "Output",ExpressionUUID->"0da4d0c5-ccbf-4ebc-9e05-618a36c0ad34"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17626, 505, 254, 4, 65, "Section",ExpressionUUID->"45afcec4-ad44-4827-9f50-1c80fb161aa6"],
Cell[17883, 511, 284, 7, 33, "Text",ExpressionUUID->"ba989ed0-1f5f-44b6-9eae-038ac0ecf8fb"],
Cell[18170, 520, 354, 7, 32, "Input",ExpressionUUID->"a0f1b1b7-e000-4f18-9254-003ddac82b24"],
Cell[18527, 529, 433, 9, 32, "Input",ExpressionUUID->"5980b7e5-3c4e-4bae-b68e-4820524b9e84"],
Cell[18963, 540, 339, 8, 33, "Text",ExpressionUUID->"8f0d3af7-83d4-4510-899a-0a96790251a1"],
Cell[19305, 550, 388, 8, 32, "Input",ExpressionUUID->"594bf9de-ef9e-47a9-b88a-80deb817588f"],
Cell[19696, 560, 273, 6, 33, "Text",ExpressionUUID->"f7775add-c9e9-449c-8818-e088dbc73ae7"],
Cell[CellGroupData[{
Cell[19994, 570, 245, 6, 32, "Input",ExpressionUUID->"439b50f9-cc6e-4044-b1e5-d2060ebb56cd"],
Cell[20242, 578, 16764, 529, 666, "Output",ExpressionUUID->"e8654515-86a3-4387-a606-c4394f6b24e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37043, 1112, 300, 7, 32, "Input",ExpressionUUID->"c3e98fe5-0b8e-4981-a4bf-a7fc4ddd064c"],
Cell[37346, 1121, 5808, 189, 305, "Output",ExpressionUUID->"c067dde3-c761-4653-a3cd-0dd5023125ca"]
}, Open  ]]
}, Open  ]]
}
]
*)

